<fieldset>
  <legend>Ways to respond</legend>
  <%= form.fields_for :consultation_participation, edition.consultation_participation || edition.build_consultation_participation do |participation_fields| %>
    <%= participation_fields.text_field :link_url, label_text: 'Link URL' %>
    <%= participation_fields.text_field :link_text %>
    <%= participation_fields.text_field :email %>
    <%= participation_fields.fields_for :consultation_response_form, participation_fields.object.consultation_response_form || participation_fields.object.build_consultation_response_form do |response_form_fields| %>
      <%= response_form_fields.text_field :title, label_text: "Downloadable response form title" %>
      <%= response_form_fields.file_field :file %>
      <% if response_form_fields.object.file_cache.present? %>
        <span class="already_uploaded"><%= File.basename(response_form_fields.object.file_cache) %> already uploaded</span>
      <% end %>
      <%= response_form_fields.hidden_field :file_cache %>
    <% end %>
  <% end %>
</fieldset>
